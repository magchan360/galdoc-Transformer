  
# 第2章：順番が命！RNNの時代


前の章で、AIはWord2Vecのおかげで、単語一つ一つの「意味」をゲットできるようになったよね。
  でもさ、文章って単語のパズルじゃないじゃん？ 「私」「学校」「行く」って単語だけあっても、「私が学校に行く」のか「学校が私に行く」のか、意味わかんないもんね。

そう、大事なのは「順番」！

時間の流れに沿ったデータ（時系列データって言うんだよ！）を処理するために生まれたのが、「RNN（リカレント・ニューラル・ネットワーク）」っていうモデルなんだ。


## 2.1 時系列を扱うモデルの誕生：Recurrent Neural Network

  「Recurrent Neural Network」、略してRNN！

  RNNを一言でいうと、「一個前の単語をちょい記憶できるAI」って感じ。

  例えば、「私」「は」「昨日」「猫」「を」「見た」っていう文章を読むとき。
  RNNはまず「私」を読んで、ふむふむってなる。
  次に「は」を読むとき、「あ、一個前に“私”がいたな」って、ちょこっとだけ覚えててくれる。
  さらに「昨日」を読むときも、「一個前は“は”だったな…」って、直前の記憶を頼りに、単語を順番に読んでいくんだ。

  この「一個前の情報を次の自分に伝言する」っていう仕組みを、ぐるぐる繰り返すから「リカレント（循環する）」って名前がついてるの。


  これって、超画期的じゃん！って思うでしょ？
  でもね、RNN君、マジで記憶力がヤバかった。例えるなら、伝言ゲームみたいな？

  短い文章ならいいんだけど、「私が昨日、公園の近くの可愛いカフェで飲んだ、あのキャラメルマキアートは、すごく美味しかった」みたいな長い文章になると、もう大変。

  「美味しかった」を読む頃には、「えーっと、主語なんだっけ？ カフェ？ 私？ マキアート？」みたいに、最初の「私」のことなんて、マジでキレイさっぱり忘れちゃってるんだよね。

  これじゃ、全然使い物になんないじゃん！ってことで、みんな頭を抱えちゃったワケ。




## 2.2 過去の記憶を保持する工夫：LSTMとGRU


  そんな記憶喪失のRNN君を救うために現れたのが、スーパーヒーロー「LSTM（ロング・ショートターム・メモリー）」！ 名前、ちょい長いけど、マジでイケてるやつだから覚えて！

  LSTMが何がすごいって、ただ記憶するんじゃなくて、記憶の「いる・いらない」を自分で判断できるようになったこと！

  LSTM君は、頭の中に「大事なことだけを書いておく、魔法のノート」を持ってるってイメージしてみて。

  文章を一個ずつ読んでいく中で、
  「あ、“私”っていう主語が出てきた！ これ、絶対あとで使うから、ノートにメモっとこ！」
  って感じで、大事な情報をノートに書き込むんだ。（これを入力ゲートって言うよ）

  逆に、「“公園の近くの”とか、まあ、飾りみたいなもんだし、忘れちゃっていいっか」
  って感じで、いらない情報をスルーする。（こっちは忘却ゲート）

  そして、文章の最後に「美味しかった」って単語が来たとき、
  「えーっと、ノート、ノート… あった！ 主語は“私”じゃなくて“キャラメルマキアート”だ！ だから、美味しかったのはマキアートのことね！」
  って、ノートを見返して、正しい答えを導き出せるようになったんだ。

  
  次に、その弟分的な存在のGRU君！
  彼は、LSTM君の仕組みを、もうちょいシンプルにした感じ。
  「ノート管理、もうちょい雑でもイケるっしょ！」って言って、いくつかの門（ゲート）を合体させちゃった。
  LSTM君ほどじゃないけど、それでも十分賢くて、計算もちょい速い。コスパのいい優等生ってワケ！


 「大事な情報だけを、長い距離持ち運べる」っていう能力のおかげで、AIの文章読解能力は、マジで爆上がりした。翻訳とか、文章の自動生成とか、一気に賢くなったんだよね。

## 2.3 RNNの限界：遠い過去は忘れ去られ、計算は遅かった

  LSTMとGRUの登場で、AIの文章読解能力はマジで神レベルになった。
  でも、まだ問題は残ってたんだ。

  それは、AIが文章を読むスピードが、ちょー遅いこと。
  LSTMって、結局は単語を一個ずつ、マジメに順番に読んでいくしかないから。長い文章だと、どうしても時間がかかっちゃう。

  それに、いくら魔法のノートがあるって言っても、限界はある。
  ちょー長い文章の、最初の方にある大事な情報と、最後の方にある大事な情報を、ガッチリ結びつけるのは、やっぱり苦手だったんだ。ノートに書ける量にも限りがあるしね。

  例えるなら、どんなに記憶力がいい人でも、電話帳を最初から最後まで一個ずつ読んで、遠く離れたページにある二つの名前の関係性を探すのは、大変じゃん？

  「もっとこう、全体をバーっと見て、大事なとこだけ、ピョンってジャンプして読めたら、最強じゃない？」

  そう、みんながそう思い始めた頃。
  この「順番に読む」っていう、誰もが当たり前だと思ってたルールそのものを、根底からひっくり返す、ヤバいアイデアが生まれることになる。

  それが、いよいよ次に出てくる「Attention」なんだ！
  